import{r as e,o as t,c as l,a as n,F as a,b as s,d as i}from"./app.9c75e1c0.js";const r={},o=n("h1",{id:"legacy-nvidia-patching",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#legacy-nvidia-patching","aria-hidden":"true"},"#"),s(" Legacy Nvidia Patching")],-1),d=n("ul",null,[n("li",null,"Please note this page is more of an info dump, we won't be going to too great of detail on setup though we plan to expand this page more for it.")],-1),c=n("p",null,"With legacy Nvidia GPUs, macOS has difficulties enabling acceleration due to many missing properties. To work around this, we can inject properties into IOService for macOS to easily interpret.",-1),u=n("p",null,"To start off, we'll be assuming the following:",-1),p=n("ul",null,[n("li",null,[s("macOS has already been installed in some way "),n("ul",null,[n("li",null,"We need macOS installed to determine certain properties")])]),n("li",null,[s("Your GPU is either Fermi or older "),n("ul",null,[n("li",null,[s("Kepler and newer "),n("strong",null,"do not"),s(" need Device Property injection")])])]),n("li",null,[s("Lilu and WhateverGreen are loaded "),n("ul",null,[n("li",null,[s("verify by running "),n("code",null,'kextstat | grep -E "Lilu|WhateverGreen"')])])])],-1),g=n("h2",{id:"finding-the-gpu-pathing",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#finding-the-gpu-pathing","aria-hidden":"true"},"#"),s(" Finding the GPU pathing")],-1),h=s("First lets grab "),y={href:"https://github.com/acidanthera/gfxutil/releases",target:"_blank",rel:"noopener noreferrer"},m=s("gfxutil"),f=s(" and run the following:"),b=n("div",{class:"language-text ext-text line-numbers-mode"},[n("pre",{class:"language-text"},[n("code",null,"path/to/gfxutil -f display\n")]),n("div",{class:"line-numbers"},[n("span",{class:"line-number"},"1"),n("br")])],-1),x=n("p",null,"This should spit out something like the following:",-1),v=n("div",{class:"language-text ext-text line-numbers-mode"},[n("pre",{class:"language-text"},[n("code",null,"67:00.0 10DE:0A20 /PC02@0/BR2A@0/GFX0@0/ = PciRoot(0x2)/Pci(0x0,0x0)/Pci(0x0,0x0)\n")]),n("div",{class:"line-numbers"},[n("span",{class:"line-number"},"1"),n("br")])],-1),w=n("p",null,"What we care about is the PciRoot section, as this is where our GPU is located and where we'll be injecting our properties:",-1),V=n("div",{class:"language-text ext-text line-numbers-mode"},[n("pre",{class:"language-text"},[n("code",null,"PciRoot(0x2)/Pci(0x0,0x0)/Pci(0x0,0x0)\n")]),n("div",{class:"line-numbers"},[n("span",{class:"line-number"},"1"),n("br")])],-1),A=n("h3",{id:"building-our-deviceproperties",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#building-our-deviceproperties","aria-hidden":"true"},"#"),s(" Building our DeviceProperties")],-1),P=n("p",null,"With Nvidia GPUs, there's actually not too many properties required for setup. The main ones that are recommended are the following:",-1),N=n("table",null,[n("thead",null,[n("tr",null,[n("th",{style:{"text-align":"left"}},"Property"),n("th",{style:{"text-align":"left"}},"Value"),n("th",{style:{"text-align":"left"}},"Comment")])]),n("tbody",null,[n("tr",null,[n("td",{style:{"text-align":"left"}},"model"),n("td",{style:{"text-align":"left"}},"ex. GeForce GT 220"),n("td",{style:{"text-align":"left"}},"GPU model name, cosmetic")]),n("tr",null,[n("td",{style:{"text-align":"left"}},"device_type"),n("td",{style:{"text-align":"left"}},"NVDA,Parent"),n("td",{style:{"text-align":"left"}},[s("Always set as "),n("code",null,"NVDA,Parent")])]),n("tr",null,[n("td",{style:{"text-align":"left"}},"VRAM,totalsize"),n("td",{style:{"text-align":"left"}},"ex. 0000004000000000"),n("td",{style:{"text-align":"left"}},"Sets VRAM size")]),n("tr",null,[n("td",{style:{"text-align":"left"}},"rom-revision"),n("td",{style:{"text-align":"left"}},"Dortania"),n("td",{style:{"text-align":"left"}},"Property must exist, however the value can be anything")]),n("tr",null,[n("td",{style:{"text-align":"left"}},"NVCAP"),n("td",{style:{"text-align":"left"}},"ex. 0500000000000F00000000000000000F00000000"),n("td",{style:{"text-align":"left"}},"sets display properties used by macOS, more info below")]),n("tr",null,[n("td",{style:{"text-align":"left"}},"@0,compatible"),n("td",{style:{"text-align":"left"}},"NVDA,NVMac"),n("td",{style:{"text-align":"left"}},[s("Always set as "),n("code",null,"NVDA,NVMac")])]),n("tr",null,[n("td",{style:{"text-align":"left"}},"@0,device_type"),n("td",{style:{"text-align":"left"}},"display"),n("td",{style:{"text-align":"left"}},[s("Always set as "),n("code",null,"display")])]),n("tr",null,[n("td",{style:{"text-align":"left"}},"@0,name"),n("td",{style:{"text-align":"left"}},"NVDA,Display-A"),n("td",{style:{"text-align":"left"}},[s("Always set as "),n("code",null,"NVDA,Display-A")])]),n("tr",null,[n("td",{style:{"text-align":"left"}},"@1,compatible"),n("td",{style:{"text-align":"left"}},"NVDA,NVMac"),n("td",{style:{"text-align":"left"}},[s("Always set as "),n("code",null,"NVDA,NVMac")])]),n("tr",null,[n("td",{style:{"text-align":"left"}},"@1,device_type"),n("td",{style:{"text-align":"left"}},"display"),n("td",{style:{"text-align":"left"}},[s("Always set as "),n("code",null,"display")])]),n("tr",null,[n("td",{style:{"text-align":"left"}},"@1,name"),n("td",{style:{"text-align":"left"}},"NVDA,Display-B"),n("td",{style:{"text-align":"left"}},[s("Always set as "),n("code",null,"NVDA,Display-B")])])])],-1),k=n("p",null,"And to calculate the properties few properties:",-1),D=n("ul",null,[n("li",null,[n("a",{href:"#model"},"model")]),n("li",null,[n("a",{href:"#vram-totalsize"},"VRAM,totalsize")]),n("li",null,[n("a",{href:"#rom-revision"},"rom-revision")]),n("li",null,[n("a",{href:"#nvcap"},"NVCAP")])],-1),C=n("h3",{id:"model",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#model","aria-hidden":"true"},"#"),s(" model")],-1),B=n("p",null,"Technically cosmetic, however macOS expects this entry so we'll provide it. The format is as follows:",-1),S=n("div",{class:"language-markdown ext-md line-numbers-mode"},[n("pre",{class:"language-markdown"},[n("code",null,[s("GeForce [Device Name]\n"),n("span",{class:"token title important"},[n("span",{class:"token punctuation"},"#"),s(" Example")]),s("\nGeForce GT 220\n")])]),n("div",{class:"line-numbers"},[n("span",{class:"line-number"},"1"),n("br"),n("span",{class:"line-number"},"2"),n("br"),n("span",{class:"line-number"},"3"),n("br")])],-1),M=n("h3",{id:"vram-totalsize",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#vram-totalsize","aria-hidden":"true"},"#"),s(" VRAM,totalsize")],-1),G=n("p",null,"Amount of VRAM present on your card, in hexadecimal.",-1),T=n("p",null,"For this example, lets convert 1024MB to hexadecimal:",-1),F=n("div",{class:"language-markdown ext-md line-numbers-mode"},[n("pre",{class:"language-markdown"},[n("code",null,[n("span",{class:"token title important"},[n("span",{class:"token punctuation"},"#"),s(" Convert 1024MB Megabytes to Bytes")]),s("\necho '1024 "),n("span",{class:"token italic"},[n("span",{class:"token punctuation"},"*"),n("span",{class:"token content"}," 1024 "),n("span",{class:"token punctuation"},"*")]),s(" 1024' | bc\n 1073741824\n\n"),n("span",{class:"token title important"},[n("span",{class:"token punctuation"},"#"),s(" Convert from decimal to hexadecimal")]),s("\necho 'obase=16; ibase=10; 1073741824' | bc\n 40000000\n\n"),n("span",{class:"token title important"},[n("span",{class:"token punctuation"},"#"),s(" Hexswap so it can be injected correctly")]),s("\n"),n("span",{class:"token title important"},[n("span",{class:"token punctuation"},"#"),s(" ie. swap in pairs")]),s("\n40000000 -> 40 00 00 00 -> 00 00 00 40\n\n"),n("span",{class:"token title important"},[n("span",{class:"token punctuation"},"#"),s(" Pad the value to 8 bytes with 00 at the end")]),s("\n00 00 00 40 00 00 00 00\n\n"),n("span",{class:"token title important"},[n("span",{class:"token punctuation"},"#"),s(" And you're done")]),s("\nVRAM,totalsize = 0000004000000000\n")])]),n("div",{class:"line-numbers"},[n("span",{class:"line-number"},"1"),n("br"),n("span",{class:"line-number"},"2"),n("br"),n("span",{class:"line-number"},"3"),n("br"),n("span",{class:"line-number"},"4"),n("br"),n("span",{class:"line-number"},"5"),n("br"),n("span",{class:"line-number"},"6"),n("br"),n("span",{class:"line-number"},"7"),n("br"),n("span",{class:"line-number"},"8"),n("br"),n("span",{class:"line-number"},"9"),n("br"),n("span",{class:"line-number"},"10"),n("br"),n("span",{class:"line-number"},"11"),n("br"),n("span",{class:"line-number"},"12"),n("br"),n("span",{class:"line-number"},"13"),n("br"),n("span",{class:"line-number"},"14"),n("br"),n("span",{class:"line-number"},"15"),n("br"),n("span",{class:"line-number"},"16"),n("br"),n("span",{class:"line-number"},"17"),n("br")])],-1),R=n("h3",{id:"rom-revision",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#rom-revision","aria-hidden":"true"},"#"),s(" rom-revision")],-1),O=n("p",null,"Simply can be any value, however the property must exist as some GPUs fail to initialize without it(ex. GT 220's)",-1),U=n("div",{class:"language-text ext-text line-numbers-mode"},[n("pre",{class:"language-text"},[n("code",null,"rom-revision = Dortania\n")]),n("div",{class:"line-numbers"},[n("span",{class:"line-number"},"1"),n("br")])],-1),_=n("h3",{id:"nvcap",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#nvcap","aria-hidden":"true"},"#"),s(" NVCAP")],-1),z=s("This is where the fun comes it, as we'll now need to calculate the NVCAP value. Thankfully for us, one of our Developers has created a tool to automate the process: "),E={href:"https://github.com/1Revenger1/NVCAP-Calculator",target:"_blank",rel:"noopener noreferrer"},I=s("NVCAP-Caluclator"),W=s("To use this program, simply grab your VBIOS("),L={href:"https://www.techpowerup.com/vgabios/",target:"_blank",rel:"noopener noreferrer"},j=s("TechPowerUp hosts most VBIOS"),H=s(") and run NVCAP-Calculator:"),Y=n("div",{class:"language-bash ext-sh line-numbers-mode"},[n("pre",{class:"language-bash"},[n("code",null,[n("span",{class:"token function"},"git"),s(" clone https://github.com/1Revenger1/NVCAP-Calculator\n"),n("span",{class:"token builtin class-name"},"cd"),s(" NVCAP-Calculator\n"),n("span",{class:"token function"},"npm"),s(),n("span",{class:"token function"},"install"),s("\n"),n("span",{class:"token function"},"npm"),s(" run run\n")])]),n("div",{class:"line-numbers"},[n("span",{class:"line-number"},"1"),n("br"),n("span",{class:"line-number"},"2"),n("br"),n("span",{class:"line-number"},"3"),n("br"),n("span",{class:"line-number"},"4"),n("br")])],-1),q=s("Note this will require NodeJS, either grab this via brew or "),J={href:"https://nodejs.org/en/",target:"_blank",rel:"noopener noreferrer"},K=s("Node JS's site"),X=n("p",null,"Once its running, you should see the following:",-1),Q=n("p",null,[n("img",{src:"/assets/nvcap-start.e52a55eb.png",alt:""})],-1),Z=n("p",null,[s("Next, enter "),n("code",null,"1"),s(" and give it your VBIOS")],-1),$=n("p",null,[n("img",{src:"/assets/nvcap-vbios.05958b76.png",alt:""})],-1),ee=n("p",null,[s("Now press enter, and return to the main menu. Once there, enter "),n("code",null,"3"),s(" to take you to the NVCAP calculation page.")],-1),te=n("p",null,[n("img",{src:"/assets/nvcap-initial-nvcap.10e1305d.png",alt:""})],-1),le=n("p",null,"Here you can see the connectors that NVCAP-Calculator was able to find. Each Display may represent multiple DCB Entries, such as DVI (normally represented as two entries) or duplicate DCB entries. The goal here is to assign each display to a head. Each head can only output to one display at a time. For example, if your using 2 DVI ports, each should be on their own head to have proper dual monitor support.",-1),ne=n("p",null,"Note that some displays may be assigned automatically. An LVDS display will be put on it's own head automatically, and TV displays will be put on the TV head automatically.",-1),ae=n("p",null,[s("To assign a display to a head, you type the number of the display then the number of the head. For example, typing in "),n("code",null,"1 1"),s(" results in:")],-1),se=n("p",null,[n("img",{src:"/assets/nvcap-assign-entry.c519584f.png",alt:""})],-1),ie=n("p",null,[s("You can type in "),n("code",null,"1 1"),s(" again to remove the display from the head. Once done, it should look something like this:")],-1),re=n("p",null,[n("img",{src:"/assets/nvcap-complete-displays.9ca4d5d3.png",alt:""})],-1),oe=n("p",null,"You should set the NVCAP values directly below the heads now as well.",-1),de=n("table",null,[n("thead",null,[n("tr",null,[n("th",{style:{"text-align":"center"}},"NVCAP Value"),n("th",{style:{"text-align":"left"}},"Details"),n("th",{style:{"text-align":"left"}},"Example Command")])]),n("tbody",null,[n("tr",null,[n("td",{style:{"text-align":"center"}},"Version"),n("td",{style:{"text-align":"left"}},[n("code",null,"04"),s(" for 7 series and older, "),n("code",null,"05"),s(" for 8 series and newer")]),n("td",{style:{"text-align":"left"}},[n("code",null,"n1 04")])]),n("tr",null,[n("td",{style:{"text-align":"center"}},"Composite"),n("td",{style:{"text-align":"left"}},[n("code",null,"01"),s(" for S-Video, "),n("code",null,"00"),s(" otherwise")]),n("td",{style:{"text-align":"left"}},[n("code",null,"n2"),s(" to toggle"),n("br"),n("code",null,"n2 true")])]),n("tr",null,[n("td",{style:{"text-align":"center"}},"Script based Power/Backlight"),n("td",{style:{"text-align":"left"}},[n("code",null,"00"),s(" ony useful for genuine MacBook Pros")]),n("td",{style:{"text-align":"left"}},[n("code",null,"n3 0")])]),n("tr",null,[n("td",{style:{"text-align":"center"}},"Field F (Unknown)"),n("td",{style:{"text-align":"left"}},[n("code",null,"0F"),s(" for 300 series and newer, otherwise "),n("code",null,"07")]),n("td",{style:{"text-align":"left"}},[n("code",null,"n4 0x0f")])])])],-1),ce=n("p",null,[s("Once done, enter in "),n("code",null,"c"),s(" to calculate the NVCAP value")],-1),ue=n("p",null,[n("img",{src:"/assets/nvcap-calculated.af00893c.png",alt:""})],-1),pe=n("p",null,"You now have your NVCAP value!",-1),ge=n("div",{class:"language-text ext-text line-numbers-mode"},[n("pre",{class:"language-text"},[n("code",null,"NVCAP: 05000000 00000300 0c000000 0000000f 00000000\n")]),n("div",{class:"line-numbers"},[n("span",{class:"line-number"},"1"),n("br")])],-1),he=n("p",null,"For those who are wanting a break down on how to calculate the NVCAP value:",-1),ye={class:"custom-container details"},me=n("summary",null,"NVCAP Table",-1),fe=s("Info based off of "),be={href:"https://github.com/acidanthera/WhateverGreen/blob/master/Manual/NVCAP.bt",target:"_blank",rel:"noopener noreferrer"},xe=s("WhateverGreen's NVCAP.bt file"),ve=i('<table><thead><tr><th style="text-align:left;">NVCAP Bit</th><th style="text-align:left;">Name</th><th style="text-align:left;">Comment</th></tr></thead><tbody><tr><td style="text-align:left;">Byte 1</td><td style="text-align:left;">NVCAP Version</td><td style="text-align:left;"><code>04</code> for 7 series and older, <code>05</code> for 8 series and newer</td></tr><tr><td style="text-align:left;">Byte 2</td><td style="text-align:left;">Laptop with Lid</td><td style="text-align:left;"><code>01</code> for true, <code>00</code> otherwise</td></tr><tr><td style="text-align:left;">Byte 3</td><td style="text-align:left;">Composite</td><td style="text-align:left;"><code>01</code> for S-Video, <code>00</code> otherwise</td></tr><tr><td style="text-align:left;">Byte 4</td><td style="text-align:left;">Backlight</td><td style="text-align:left;"><code>01</code> for Tesla V1 with Backlight, otherwise <code>00</code> for newer GPUs regardless of screen type</td></tr><tr><td style="text-align:left;">Bytes 5+6</td><td style="text-align:left;">TVDCBMask</td><td style="text-align:left;"><code>00 00</code>, relates to DCB entry 5</td></tr><tr><td style="text-align:left;">Bytes 7+8</td><td style="text-align:left;">Head0DCBMask</td><td style="text-align:left;"><code>00 00</code>, see below</td></tr><tr><td style="text-align:left;">Bytes 9+10</td><td style="text-align:left;">Head1DCBMask</td><td style="text-align:left;"><code>00 00</code>, see below</td></tr><tr><td style="text-align:left;">Bytes 11+12</td><td style="text-align:left;">Head2DCBMask</td><td style="text-align:left;"><code>00 00</code>, non-applicable for Fermi and older</td></tr><tr><td style="text-align:left;">Bytes 13+14</td><td style="text-align:left;">Head3DCBMask</td><td style="text-align:left;"><code>00 00</code>, non-applicable for Fermi and older</td></tr><tr><td style="text-align:left;">Byte 15</td><td style="text-align:left;">ScriptBasedPowerAndBacklight</td><td style="text-align:left;"><code>00</code>, only relevant for genuine MacBook Pros</td></tr><tr><td style="text-align:left;">Byte 16</td><td style="text-align:left;">Unknown</td><td style="text-align:left;"><code>0F</code> for 300 series and newer, otherwise <code>07</code></td></tr><tr><td style="text-align:left;">Byte 17</td><td style="text-align:left;">EDID</td><td style="text-align:left;"><code>00</code></td></tr><tr><td style="text-align:left;">Byte 18</td><td style="text-align:left;">Reserved</td><td style="text-align:left;"><code>00</code></td></tr><tr><td style="text-align:left;">Byte 19</td><td style="text-align:left;">Reserved</td><td style="text-align:left;"><code>00</code></td></tr><tr><td style="text-align:left;">Byte 20</td><td style="text-align:left;">Reserved</td><td style="text-align:left;"><code>00</code></td></tr></tbody></table>',1),we=n("h3",{id:"cleaning-up",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#cleaning-up","aria-hidden":"true"},"#"),s(" Cleaning up")],-1),Ve=n("p",null,"Now that we've gotten all our properties, we can now add em up and place them in our config.plist:",-1),Ae=n("div",{class:"language-text ext-text line-numbers-mode"},[n("pre",{class:"language-text"},[n("code",null,"PciRoot(0x2)/Pci(0x0,0x0)/Pci(0x0,0x0)\n\nmodel          | String | GeForce GT 220\ndevice_type    | String | NVDA,Parent\nVRAM,totalsize |  Data  | 0000004000000000\nrom-revision   | String | Dortania\nNVCAP          |  Data  | 05000000 00000300 0c000000 0000000f 00000000\n@0,compatible  | String | NVDA,NVMac\n@0,device_type | String | display\n@0,name        | String | NVDA,Display-A\n@1,compatible  | String | NVDA,NVMac\n@1,device_type | String | display\n@1,name        | String | NVDA,Display-B\n")]),n("div",{class:"line-numbers"},[n("span",{class:"line-number"},"1"),n("br"),n("span",{class:"line-number"},"2"),n("br"),n("span",{class:"line-number"},"3"),n("br"),n("span",{class:"line-number"},"4"),n("br"),n("span",{class:"line-number"},"5"),n("br"),n("span",{class:"line-number"},"6"),n("br"),n("span",{class:"line-number"},"7"),n("br"),n("span",{class:"line-number"},"8"),n("br"),n("span",{class:"line-number"},"9"),n("br"),n("span",{class:"line-number"},"10"),n("br"),n("span",{class:"line-number"},"11"),n("br"),n("span",{class:"line-number"},"12"),n("br"),n("span",{class:"line-number"},"13"),n("br")])],-1),Pe=n("p",null,[s("Open your config.plist and head to "),n("code",null,"DeviceProperties -> Add"),s(", next create a new child with the name of your GPU's path(ie the one with gfxutil). Then, finally add the properties as children to the PciRoot. You should end up with something similar:")],-1),Ne=n("p",null,[n("img",{src:"/assets/deviceproperties.37ec7832.png",alt:""})],-1);r.render=function(s,i){const r=e("OutboundLink");return t(),l(a,null,[o,d,c,u,p,g,n("p",null,[h,n("a",y,[m,n(r)]),f]),b,x,v,w,V,A,P,N,k,D,C,B,S,M,G,T,F,R,O,U,_,n("p",null,[z,n("a",E,[I,n(r)])]),n("p",null,[W,n("a",L,[j,n(r)]),H]),Y,n("ul",null,[n("li",null,[q,n("a",J,[K,n(r)])])]),X,Q,Z,$,ee,te,le,ne,ae,se,ie,re,oe,de,ce,ue,pe,ge,he,n("details",ye,[me,n("p",null,[fe,n("a",be,[xe,n(r)])]),ve]),we,Ve,Ae,Pe,Ne],64)};export default r;
