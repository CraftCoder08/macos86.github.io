import{r as e,o as n,c as a,a as l,w as i,F as s,b as o,d as r}from"./app.9c75e1c0.js";const t={},u=l("h1",{id:"debug-del-sistema-approfondito",tabindex:"-1"},[l("a",{class:"header-anchor",href:"#debug-del-sistema-approfondito","aria-hidden":"true"},"#"),o(" Debug del sistema: approfondito")],-1),c=l("p",null,"Questa sezione andrà un po 'più in profondità nella risoluzione dei problemi, concentrandosi in particolare su un debug di livello più basso con un output di debug appropriato e una configurazione seriale opzionale.",-1),p=l("p",null,[l("strong",null,"Note"),o(": Il 99% degli utenti non ha bisogno di questo livello di debug, questo è solo per casi estremi o estremi.")],-1),d={class:"table-of-contents"},m=o("# EFI Setup"),b=o("# Configurazione Config.plist"),g=o("# Misc"),h=o("# NVRAM"),v=o("# Serial Setup(Opzionale)"),k=o("# Hardware Setup"),f=o("# CoolTerm Setup"),z=o("# Kernel Debug Kits (Opzionale)"),S=o("# KDK su un sistema operativo installato"),x=o("# Disinstallazione di KDK"),_=l("h2",{id:"efi-setup",tabindex:"-1"},[l("a",{class:"header-anchor",href:"#efi-setup","aria-hidden":"true"},"#"),o(" EFI Setup")],-1),D=o("Per la maggior parte, sono necessarie modifiche abbastanza minime. Le cose principali che consigliamo sono la versione DEBUG di "),A=l("strong",null,"OpenCore",-1),P=o(" e di tutti i tuoi "),K=l("strong",null,"kexts",-1),B=o(". Questo può aiutarti a ottenere tutti i dati necessari, vedi qui per maggiori dettagli sul debug di OpenCore: "),C=o("OpenCore debugging"),I=l("p",null,"Oltre a utilizzare solo le varianti DEBUG di OpenCore e kexts, anche questi strumenti possono essere di grande aiuto:",-1),O={href:"https://github.com/acidanthera/DebugEnhancer/releases",target:"_blank",rel:"noopener noreferrer"},R=o("DebugEnhancer.kext"),E=o("Aiuta molto con il debug del kernel mentre si applica anche la patch "),T={href:"https://github.com/acidanthera/DebugEnhancer/blob/4495911971011a1a7a0ffe8605d6ca4b341f67d9/DebugEnhancer/kern_dbgenhancer.cpp#L131",target:"_blank",rel:"noopener noreferrer"},y=o("kern.msgbuf to 10485760"),F=o(" e consentendo un registro del kernel molto più grande."),U=l("li",null,"Nota che questo kext non si può caricare con l'inizializzazione del kernel, quindi i primi log non vengono aggiornati finché il kext non viene caricato subito prima della fase di configurazione PCI",-1),w={href:"https://gist.github.com/al3xtjames/39ebea4d615c8aed829109a9ea2cd0b5",target:"_blank",rel:"noopener noreferrer"},q=o("SSDT-DBG"),N=l("li",null,"Abilita le istruzioni di debug dalle tabelle ACPI, aiutando per il debug degli eventi ACPI nel sistema operativo",-1),M=o("Nota che dovrai anche "),G=o("compilare l'SSDT"),L=l("h2",{id:"configurazione-config-plist",tabindex:"-1"},[l("a",{class:"header-anchor",href:"#configurazione-config-plist","aria-hidden":"true"},"#"),o(" Configurazione Config.plist")],-1),V=l("p",null,"Per la configurazione seriale, OpenCore lo rende in realtà abbastanza semplice.",-1),X=l("h3",{id:"misc",tabindex:"-1"},[l("a",{class:"header-anchor",href:"#misc","aria-hidden":"true"},"#"),o(" Misc")],-1),H=l("li",null,[l("strong",null,"SerialInt"),o(": YES "),l("ul",null,[l("li",null,"Esegue l'inizializzazione della porta seriale")])],-1),Q=l("strong",null,"Target",-1),j=o(": "),Y=l("code",null,"67",-1),Z=l("li",null,"Abilita l'output di debug con OpenCore",-1),W=l("li",null,[o("Target=75 aggiunge il flag di output seriale aggiuntivo (0x08) se "),l("a",{href:"#configurazione-seriale-opzionale"},"prevedi di utilizzare seriale")],-1),J=o("Puoi calcolare il tuo valore qui: "),$=o("OpenCore debugging"),ee=l("h3",{id:"nvram",tabindex:"-1"},[l("a",{class:"header-anchor",href:"#nvram","aria-hidden":"true"},"#"),o(" NVRAM")],-1),ne=l("h4",{id:"argomenti-di-avvio",tabindex:"-1"},[l("a",{class:"header-anchor",href:"#argomenti-di-avvio","aria-hidden":"true"},"#"),o(" Argomenti di avvio")],-1),ae=l("p",null,"Qui possiamo impostare alcune variabili che ci aiuteranno con l'output di debug, per noi utilizzeremo i seguenti argomenti di avvio:",-1),le=l("div",{class:"language-text ext-text line-numbers-mode"},[l("pre",{class:"language-text"},[l("code",null,"-v keepsyms=1 debug=0x12a msgbuf=1048576\n")]),l("div",{class:"line-numbers"},[l("span",{class:"line-number"},"1"),l("br")])],-1),ie=l("p",null,"Ora vediamo cosa fa ogni argomento:",-1),se=l("li",null,[l("strong",null,"-v"),l("ul",null,[l("li",null,"Abilita l'output dettagliato")])],-1),oe=l("li",null,[l("strong",null,"keepsyms=1"),l("ul",null,[l("li",null,"Assicura che i simboli vengano conservati durante i kernel panic, che sono molto utili per la risoluzione dei problemi")])],-1),re=l("strong",null,"debug=0x12a",-1),te=l("li",null,[o("Combinazione di "),l("code",null,"DB_KPRT"),o("(0x8), "),l("code",null,"DB_KDP_BP_DIS"),o("(0x32), "),l("code",null,"DB_KDP_GETC_ENA(0x200)")],-1),ue=o("Un elenco completo dei valori può essere trovato qui: "),ce={href:"https://github.com/apple/darwin-xnu/blob/master/osfmk/kern/debug.h#L419L447",target:"_blank",rel:"noopener noreferrer"},pe=o("debug.h"),de=l("li",null,[l("strong",null,"msgbuf=1048576"),l("ul",null,[l("li",null,"Imposta la dimensione del buffer dei messaggi del kernel, questo aiuta a ottenere i log corretti durante l'avvio"),l("li",null,"1048576 is 1MB(/1024^2), può essere più grande se necessario"),l("li",null,"Nota non richiesta con DebugEnhancer.kext, tuttavia per i primi log del kernel è ancora richiesta")])],-1),me=l("p",null,[l("strong",null,"Altri utili Argomenti di avvio"),o(":")],-1),be=l("p",null,"A seconda di cosa stai eseguendo il debug, potresti trovare anche questi argomenti di avvio estremamente utili:",-1),ge=r('<li><strong>-liludbgall</strong><ul><li>Abilita il debug su Lilu e qualsiasi altro plugin, tieni presente che anche questo richiede versioni DEBUG di kexts</li></ul></li><li><strong>io=0xff</strong><ul><li>Abilita il debug di IOKit, con un output maggiore. Tieni presente che la quantità di registrazione di questo parametro sarà enorme e rallenterà il sistema. Soprattutto durante l&#39;avvio.</li></ul></li><li><strong>igdebug=0xff</strong><ul><li>Abilita il debug relativo a iGPU, utile quando si lavora con i sistemi iGPU</li></ul></li><li><strong>serial=5</strong><ul><li>Reindirizza l&#39;output a seriale se si<a href="#serial-setup-optional">prevede di utilizzare il seriale</a></li><li>Consigliato per l&#39;output iniziale del kernel prima della configurazione PCI</li></ul></li>',4),he=l("strong",null,"acpi_layer=0x8",-1),ve=o("Abilita il debug di "),ke=l("code",null,"ACPI_TABLES",-1),fe=o(", vedi "),ze={href:"https://github.com/acpica/acpica/blob/master/source/include/acoutput.h",target:"_blank",rel:"noopener noreferrer"},Se=o("acoutput.h"),xe=o(" per maggiori informazioni"),_e=l("li",null,[l("code",null,"0xFFFFFFFF"),o(" in alternativa abilita tutti i livelli")],-1),De=l("strong",null,"acpi_level=0x2",-1),Ae=o("Imposta il debug di "),Pe=l("code",null,"ACPI_LV_DEBUG_OBJECT",-1),Ke=o(", vedi "),Be={href:"https://github.com/acpica/acpica/blob/master/source/include/acoutput.h",target:"_blank",rel:"noopener noreferrer"},Ce=o("acoutput.h"),Ie=o(" per maggiori informazioni"),Oe=l("li",null,[l("code",null,"0xFFFF5F"),o(' in alternativa implica "ACPI_ALL_COMPONENTS"')],-1),Re=l("h2",{id:"serial-setup-opzionale",tabindex:"-1"},[l("a",{class:"header-anchor",href:"#serial-setup-opzionale","aria-hidden":"true"},"#"),o(" Serial Setup(Opzionale)")],-1),Ee=l("ul",null,[l("li",null,[l("a",{href:"#hardware-setup"},"Hardware Setup")]),l("li",null,[l("a",{href:"#efi-setup"},"EFI Setup")]),l("li",null,[l("a",{href:"#config-plist-setup"},"Config.plist Setup")])],-1),Te=l("p",null,[o("Sebbene facoltativo, il seriale può essere molto utile per acquisire tutte le informazioni importanti che invadono il tuo PC. È anche l'unico modo per registrare correttamente i primi kernel panic (come le cose subito dopo "),l("code",null,"[EB | #LOG: EXITBS: START]"),o(")")],-1),ye=l("p",null,"Per questa configurazione, avrai bisogno di alcune cose:",-1),Fe=l("li",null,"Una porta seriale sulla macchina che si testa",-1),Ue=l("li",null,"Un cavo da seriale a seriale o da seriale a USB",-1),we=l("li",null,"Una seconda macchina per ricevere la registrazione seriale (con seriale o USB)",-1),qe=o("Software per monitorare l'uscita seriale "),Ne=o("Per questa guida, utilizzeremo "),Me={href:"https://freeware.the-meiers.org",target:"_blank",rel:"noopener noreferrer"},Ge=o("CoolTerm"),Le=o(" poiché supporta macOS, Linux, Windows e persino Raspberry Pi "),Ve=l("ul",null,[l("li",null,[o("Anche "),l("code",null,"screen"),o(" e altri metodi sono supportati.")])],-1),Xe=l("h3",{id:"hardware-setup",tabindex:"-1"},[l("a",{class:"header-anchor",href:"#hardware-setup","aria-hidden":"true"},"#"),o(" Hardware Setup")],-1),He=l("p",null,"Per questo esempio, utilizzeremo una scheda Asus X299-E Strix che ha una porta seriale. Per verificare se la tua scheda ne ha una, controlla il manuale utente o di servizio e cerca la porta seriale/COM:",-1),Qe=l("p",null,[l("img",{src:"/assets/serial-header.13b86689.png",alt:""})],-1),je=l("p",null,"Come puoi vedere, abbiamo una porta COM nella parte inferiore della nostra scheda madre e cè anche un diagramma per collegare manualmente i nostri pin seriali se non stai utilizzando un connettore seriale 9/10 pin per l'adattatore DB9.",-1),Ye=l("p",null,[o("In alternativa, alcune macchine sono dotate di porte seriali DB9 proprio sull'IO posteriore come questo Dell Optiplex 780 SFF (si noti che VGA e seriale "),l("strong",null,"non"),o(" sono lo stesso connettore):")],-1),Ze=l("p",null,[l("img",{src:"/assets/serial-connector.6b0c78aa.jpg",alt:""})],-1),We=o("Per la mia configurazione X299, sto usando un semplice file "),Je={href:"https://www.amazon.ca/gp/product/B001Y1F0HW/ref=ppx_yo_dt_b_asin_title_o00_s00?ie=UTF8&psc=1",target:"_blank",rel:"noopener noreferrer"},$e=o("Serial header to DB9"),en=o(", e un "),nn={href:"https://www.amazon.ca/gp/product/B075YGKFC1/ref=ppx_yo_dt_b_asin_title_o00_s01?ie=UTF8&psc=1",target:"_blank",rel:"noopener noreferrer"},an=o("DB9 to USB RS 232 adapter"),ln=o(" che alla fine termina sul mio laptop:"),sn=l("table",null,[l("thead",null,[l("tr",null,[l("th",{style:{"text-align":"left"}},"Serial header to DB9"),l("th",{style:{"text-align":"left"}},"DB9 to USB RS 232 adapter")])]),l("tbody",null,[l("tr",null,[l("td",{style:{"text-align":"left"}},[l("img",{src:"/assets/817DNdBZDkL._AC_SL1500_.0f12cdc8.jpg",alt:""})]),l("td",{style:{"text-align":"left"}},[l("img",{src:"/assets/61yHczOwpTL._AC_SL1001_.e9779065.jpg",alt:""})])])])],-1),on=l("p",null,"Il manuale OpenCore generalmente consiglia dispositivi UART basati su CP21202:",-1),rn=l("blockquote",null,[l("p",null,'Per ottenere il log durante l\'avvio è possibile utilizzare il debug della porta seriale. Il debug della porta seriale è abilitato in Target, ad es. 0xB per sullo schermo con seriale. OpenCore utilizza una velocità di trasmissione di 115200, 8 bit di dati, nessuna parità e 1 bit di stop. Per macOS la scelta migliore sono i dispositivi UART basati su CP2102. Collega la scheda madre TX a USB UART RX e la scheda madre GND a USB UART GND. Utilizzare l\'utilità dello schermo per ottenere l\'output o scaricare il software GUI, come CoolTerm. Nota: su diverse schede madri (e possibilmente su dongle USB UART) la denominazione del PIN potrebbe non essere corretta. È molto comune avere GND scambiato con RX, quindi è necessario collegare la scheda madre "TX" a USB UART GND e la scheda madre "GND" a USB UART RX.')],-1),tn=l("p",null,[l("strong",null,"Promemoria importante"),o(": non dimenticare di abilitare anche la porta seriale nel BIOS, la maggior parte delle schede madri la disabilita per impostazione predefinita")],-1),un=l("h3",{id:"coolterm-setup",tabindex:"-1"},[l("a",{class:"header-anchor",href:"#coolterm-setup","aria-hidden":"true"},"#"),o(" CoolTerm Setup")],-1),cn=o("Ora avvia "),pn={href:"https://freeware.the-meiers.org",target:"_blank",rel:"noopener noreferrer"},dn=o("CoolTerm"),mn=o(" e imposta alcune opzioni. Quando apri CoolTerm, verrai probabilmente accolto con una semplice finestra. Qui seleziona la voce Opzioni:"),bn=l("p",null,[l("img",{src:"/assets/coolterm-first-start.43905627.png",alt:""}),l("img",{src:"/assets/coolterm-settings.1502a9ec.png",alt:""})],-1),gn=l("p",null,"Qui ci vengono fornite alcune opzioni, ma quelle principali a cui teniamo sono:",-1),hn=l("ul",null,[l("li",null,"Port: Assicurati che corrisponda al tuo controller seriale."),l("li",null,"Baudrate = 115200"),l("li",null,"Data Bits = 8"),l("li",null,"Parity = none"),l("li",null,"Stop Bit = 1")],-1),vn=l("p",null,"Quindi salvare queste impostazioni e selezionare la voce Connetti. Questo ti fornirà un registro in tempo reale da seriale:",-1),kn=l("p",null,[l("img",{src:"/assets/coolterm-connect.b70e8574.png",alt:""})],-1),fn=l("p",null,[o("Per registrare, vai semplicemente su "),l("code",null,"Connections -> Capture to Text/Binary File -> Start...(Cmd+R)"),o(":")],-1),zn=l("p",null,[l("img",{src:"/assets/coolterm-record.22d1c655.png",alt:""})],-1),Sn=l("h2",{id:"kernel-debug-kits-opzionale",tabindex:"-1"},[l("a",{class:"header-anchor",href:"#kernel-debug-kits-opzionale","aria-hidden":"true"},"#"),o(" Kernel Debug Kits (Opzionale)")],-1),xn=l("ul",null,[l("li",null,[l("a",{href:"#kdk-on-an-installed-os"},"KDK su un sistema operativo installato")]),l("li",null,[l("a",{href:"#uninstalling-the-kdk"},"Disinstallazione di KDK")])],-1),_n=l("p",null,'I kit di debug del kernel (KDK) sono un ottimo modo per ottenere ancora più informazioni di registrazione dal kernel e dai kext principali, in particolare i KDK sono versioni di debug delle fondamenta di base di macOS fornite da Apple stessa. Includono sia più registrazione che ASSERT che ti consentono di vedere più direttamente i problemi con la tua configurazione. Nota tuttavia non discuteremo del debug con bridge o dell\'utilizzo di "lldb".',-1),Dn=l("p",null,[l("span",{style:{color:"red"}}," CAUTION: "),o(" L'installazione di KDK su macchine da lavoro può portare a problemi con gli aggiornamenti del sistema operativo e corrompere le installazioni. Eseguire il debug su installazioni macOS dedicate per evitare la perdita di dati")],-1),An=o("Per iniziare, avremo come minimo bisogno di un "),Pn={href:"https://developer.apple.com/support/compare-memberships/",target:"_blank",rel:"noopener noreferrer"},Kn=o("account sviluppatore gratuito"),Bn=o(" da Apple. Dopo esserti registrato come minimo ad un livello gratuito, ora puoi accedere ai KDK da "),Cn={href:"https://developer.apple.com/download/more/",target:"_blank",rel:"noopener noreferrer"},In=o("More Downloads page"),On=o(":"),Rn=o("Nota: i livelli gratuiti saranno limitati al rilascio di KDK, beta beta di KDKs sono fornite solo ad "),En={href:"https://developer.apple.com/support/compare-memberships/",target:"_blank",rel:"noopener noreferrer"},Tn=o("account sviluppatore a pagamento"),yn=l("li",null,"Nota 2: Apple ospita KDK fin da OS X 10.5, Leopard, quindi non preoccuparti che il tuo sistema operativo non sia supportato.",-1),Fn=l("p",null,[l("img",{src:"/assets/more-downloads.599aca2c.png",alt:""})],-1),Un=l("p",null,"Per determinare quale build KDK ti serve con le build beta, esegui quanto segue nel terminale:",-1),wn=l("div",{class:"language-bash ext-sh line-numbers-mode"},[l("pre",{class:"language-bash"},[l("code",null,[o("sw_vers "),l("span",{class:"token operator"},"|"),o(),l("span",{class:"token function"},"grep"),o(" BuildVersion\n")])]),l("div",{class:"line-numbers"},[l("span",{class:"line-number"},"1"),l("br")])],-1),qn=l("p",null,'Per questo, scaricherò il kit di debug del kernel 11.3 build 20E5186d. Una volta scaricato, monta l\'immagine del disco e troverai il programma di installazione di KDK. Per impostazione predefinita, il KDK si installerà solo per "Esecuzione del debug su due macchine" e non fornirà alcun vantaggio aggiuntivo sulla macchina host per il debug del kernel per impostazione predefinita.',-1),Nn=l("h3",{id:"kdk-su-un-sistema-operativo-installato",tabindex:"-1"},[l("a",{class:"header-anchor",href:"#kdk-su-un-sistema-operativo-installato","aria-hidden":"true"},"#"),o(" KDK su un sistema operativo installato")],-1),Mn=l("p",null,"Per abilitare il debug sulla macchina host, dovrai eseguire le seguenti operazioni:",-1),Gn=l("ol",null,[l("li",null,"Eseguire KDK Install pkg"),l("li",null,"Disabilitare SIP(OS X 10.11+)"),l("li",null,"Montare la partizione di root come scrivibile(macOS 10.15+)"),l("li",null,"Installa il kernel di debug e kexts"),l("li",null,"Aggiorna Argomenti di avvio"),l("li",null,"Riavvia e controlla il tuo lavoro")],-1),Ln=l("h4",{id:"_1-esegui-kdk-install-pkg",tabindex:"-1"},[l("a",{class:"header-anchor",href:"#_1-esegui-kdk-install-pkg","aria-hidden":"true"},"#"),o(" 1. Esegui KDK Install pkg")],-1),Vn=l("p",null,"Esegui semplicemente il pkg come di consueto:",-1),Xn=l("p",null,[l("img",{src:"/assets/kdk-install.eb37cb07.png",alt:""})],-1),Hn=l("p",null,[o("Una volta installati, troverai i componenti KDK come il kernel di debug in "),l("code",null,"/Library/Developer/KDKs"),o(":")],-1),Qn=l("p",null,[l("img",{src:"/assets/kdk-installed.2b301fd7.png",alt:""})],-1),jn=l("h4",{id:"_2-disabilitare-sip",tabindex:"-1"},[l("a",{class:"header-anchor",href:"#_2-disabilitare-sip","aria-hidden":"true"},"#"),o(" 2. Disabilitare SIP")],-1),Yn=l("ul",null,[l("li",null,"Applicabile a OS X 10.11, El Capitan e più recenti")],-1),Zn=l("p",null,"Per disabilitare SIP, gli utenti hanno 2 scelte:",-1),Wn=l("li",null,[l("p",null,"Disabilitare tramite Recovery")],-1),Jn=o("Disabilitare tramite config.plist"),$n=l("p",null,"In genere consigliamo vivamente di usare la Recovery per ripristinare più facilmente tramite il reset NVRAM, tuttavia ad alcuni utenti potrebbe essere richiesto che SIP venga disabilitato anche per effettuare il reset.",-1),ea=l("p",null,"Per il primo metodo, riavvia semplicemente in macOS Recovery, apri il terminale ed esegui quanto segue:",-1),na=l("div",{class:"language-bash ext-sh line-numbers-mode"},[l("pre",{class:"language-bash"},[l("code",null,[o("csrutil disable\ncsrutil authenticated-root disable "),l("span",{class:"token comment"},"# Big Sur+"),o("\n")])]),l("div",{class:"line-numbers"},[l("span",{class:"line-number"},"1"),l("br"),l("span",{class:"line-number"},"2"),l("br")])],-1),aa=l("p",null,[o("Riavvia e SIP sarà stato regolato di conseguenza. Puoi eseguire "),l("code",null,"csrutil status"),o(" nel terminale per verificare che abbia funzionato.")],-1),la=l("span",{style:{color:"red"}}," ATTENZIONE: ",-1),ia=o(" Per gli utenti che fanno affidamento sulla "),sa=o("funzionalità ApECID di OpenCore"),oa=o(", tieni presente che "),ra=l("strong",null,"deve",-1),ta=o(" essere disabilitato per utilizzare KDK."),ua=l("h4",{id:"_3-montare-la-partizione-di-root-come-scrivibile",tabindex:"-1"},[l("a",{class:"header-anchor",href:"#_3-montare-la-partizione-di-root-come-scrivibile","aria-hidden":"true"},"#"),o(" 3. Montare la partizione di root come scrivibile")],-1),ca=l("ul",null,[l("li",null,"Applicabile for macOS 10.15, Catalina e più recenti")],-1),pa=l("p",null,"Mounting the root volume as writable is easy, however the process is a bit long:",-1),da=l("div",{class:"language-bash ext-sh line-numbers-mode"},[l("pre",{class:"language-bash"},[l("code",null,[l("span",{class:"token comment"},"# Big Sur+"),o("\n"),l("span",{class:"token comment"},"# Innanzitutto, crea un mount point per la tua unità"),o("\n"),l("span",{class:"token function"},"mkdir"),o(" ~/livemount\n\n"),l("span",{class:"token comment"},"# Quindi, trova il tuo volume di sistema"),o("\ndiskutil list\n\n"),l("span",{class:"token comment"},"# Dall'elenco sottostante, possiamo vedere che il nostro volume di sistema è disk5s5"),o("\n/dev/disk5 "),l("span",{class:"token punctuation"},"("),o("synthesized"),l("span",{class:"token punctuation"},")"),o(":\n   "),l("span",{class:"token comment"},"#:                       TYPE NAME                    SIZE       IDENTIFIER"),o("\n   "),l("span",{class:"token number"},"0"),o(":      APFS Container Scheme -                      +255.7 GB   disk5\n                                 Physical Store disk4s2\n   "),l("span",{class:"token number"},"1"),o(":                APFS Volume ⁨Big Sur HD - Data⁩       "),l("span",{class:"token number"},"122.5"),o(" GB   disk5s1\n   "),l("span",{class:"token number"},"2"),o(":                APFS Volume ⁨Preboot⁩                 "),l("span",{class:"token number"},"309.4"),o(" MB   disk5s2\n   "),l("span",{class:"token number"},"3"),o(":                APFS Volume ⁨Recovery⁩                "),l("span",{class:"token number"},"887.8"),o(" MB   disk5s3\n   "),l("span",{class:"token number"},"4"),o(":                APFS Volume ⁨VM⁩                      "),l("span",{class:"token number"},"1.1"),o(" MB     disk5s4\n   "),l("span",{class:"token number"},"5"),o(":                APFS Volume ⁨Big Sur HD⁩              "),l("span",{class:"token number"},"16.2"),o(" GB    disk5s5\n   "),l("span",{class:"token number"},"6"),o(":              APFS Snapshot ⁨com.apple.os.update-"),l("span",{class:"token punctuation"},".."),o(".⁩ "),l("span",{class:"token number"},"16.2"),o(" GB    disk5s5s\n\n"),l("span",{class:"token comment"},"# Montare l'unità (es. Disk5s5)"),o("\n"),l("span",{class:"token function"},"sudo"),o(),l("span",{class:"token function"},"mount"),o(" -o nobrowse -t apfs  /dev/disk5s5 ~/livemount\n\n"),l("span",{class:"token comment"},"# Ora puoi apportare liberamente qualsiasi modifica al volume di sistema"),o("\n")])]),l("div",{class:"line-numbers"},[l("span",{class:"line-number"},"1"),l("br"),l("span",{class:"line-number"},"2"),l("br"),l("span",{class:"line-number"},"3"),l("br"),l("span",{class:"line-number"},"4"),l("br"),l("span",{class:"line-number"},"5"),l("br"),l("span",{class:"line-number"},"6"),l("br"),l("span",{class:"line-number"},"7"),l("br"),l("span",{class:"line-number"},"8"),l("br"),l("span",{class:"line-number"},"9"),l("br"),l("span",{class:"line-number"},"10"),l("br"),l("span",{class:"line-number"},"11"),l("br"),l("span",{class:"line-number"},"12"),l("br"),l("span",{class:"line-number"},"13"),l("br"),l("span",{class:"line-number"},"14"),l("br"),l("span",{class:"line-number"},"15"),l("br"),l("span",{class:"line-number"},"16"),l("br"),l("span",{class:"line-number"},"17"),l("br"),l("span",{class:"line-number"},"18"),l("br"),l("span",{class:"line-number"},"19"),l("br"),l("span",{class:"line-number"},"20"),l("br"),l("span",{class:"line-number"},"21"),l("br"),l("span",{class:"line-number"},"22"),l("br"),l("span",{class:"line-number"},"23"),l("br")])],-1),ma=l("div",{class:"language-bash ext-sh line-numbers-mode"},[l("pre",{class:"language-bash"},[l("code",null,[l("span",{class:"token comment"},"# Solo Catalina"),o("\n"),l("span",{class:"token function"},"sudo"),o(),l("span",{class:"token function"},"mount"),o(" -uw /\n")])]),l("div",{class:"line-numbers"},[l("span",{class:"line-number"},"1"),l("br"),l("span",{class:"line-number"},"2"),l("br")])],-1),ba=l("h4",{id:"_4-installa-il-kernel-di-debug-e-kexts",tabindex:"-1"},[l("a",{class:"header-anchor",href:"#_4-installa-il-kernel-di-debug-e-kexts","aria-hidden":"true"},"#"),o(" 4. Installa il kernel di debug e kexts")],-1),ga=l("p",null,"Ora installiamo il nostro KDK nel sistema:",-1),ha=l("div",{class:"language-bash ext-sh line-numbers-mode"},[l("pre",{class:"language-bash"},[l("code",null,[l("span",{class:"token comment"},"# Installa KDK nel volume di sistema"),o("\n"),l("span",{class:"token comment"},"# Assicurati di sostituire <KDK Version>"),o("\n"),l("span",{class:"token comment"},"# Per 10.15 e versioni precedenti, scambia livemount con /Volumes/<Target Volume>"),o("\n"),l("span",{class:"token function"},"sudo"),o(" ditto /Library/Developer/KDKs/"),l("span",{class:"token operator"},"<"),o("KDK Version"),l("span",{class:"token operator"},">"),o("/System ~/livemount/System\n\n"),l("span",{class:"token comment"},"# Ricostruisci la cache del kernel (Big Sur e versioni successive)"),o("\n"),l("span",{class:"token function"},"sudo"),o(" kmutil "),l("span",{class:"token function"},"install"),o(" --volume-root ~/livemount --update-all\n\n"),l("span",{class:"token comment"},"# Ricostruisci la cache del kernel (Catalina e versioni precedenti)"),o("\n"),l("span",{class:"token function"},"sudo"),o(" kextcache -invalidate /Volumes/"),l("span",{class:"token operator"},"<"),o("Target Volume"),l("span",{class:"token operator"},">"),o("\n\n"),l("span",{class:"token comment"},"# Infine, una volta terminata la modifica del volume di sistema"),o("\n"),l("span",{class:"token comment"},"# vorremo creare un nuovo snapshot (Big Sur e più recenti)"),o("\n"),l("span",{class:"token function"},"sudo"),o(" bless --folder ~/livemount/System/Library/CoreServices --bootefi --create-snapshot\n")])]),l("div",{class:"line-numbers"},[l("span",{class:"line-number"},"1"),l("br"),l("span",{class:"line-number"},"2"),l("br"),l("span",{class:"line-number"},"3"),l("br"),l("span",{class:"line-number"},"4"),l("br"),l("span",{class:"line-number"},"5"),l("br"),l("span",{class:"line-number"},"6"),l("br"),l("span",{class:"line-number"},"7"),l("br"),l("span",{class:"line-number"},"8"),l("br"),l("span",{class:"line-number"},"9"),l("br"),l("span",{class:"line-number"},"10"),l("br"),l("span",{class:"line-number"},"11"),l("br"),l("span",{class:"line-number"},"12"),l("br"),l("span",{class:"line-number"},"13"),l("br"),l("span",{class:"line-number"},"14"),l("br")])],-1),va=l("h4",{id:"_5-aggiornare-argomenti-di-avvio",tabindex:"-1"},[l("a",{class:"header-anchor",href:"#_5-aggiornare-argomenti-di-avvio","aria-hidden":"true"},"#"),o(" 5. Aggiornare Argomenti di avvio")],-1),ka=l("p",null,"Ora che hai finito di configurare KDK e di averlo installato, dobbiamo dire a boot.efi quale kernel usare. Hai 2 opzioni tra cui scegliere:",-1),fa=l("ul",null,[l("li",null,[l("code",null,"kcsuffix=debug"),o(" (removed with Big Sur)")]),l("li",null,[l("code",null,"kcsuffix=development")]),l("li",null,[l("code",null,"kcsuffix=kasan")])],-1),za=l("code",null,"development",-1),Sa=o(" arg imposterà il nuovo kernel di debug predefinito in Big Sur, mentre "),xa=l("code",null,"kasan",-1),_a=o(" è un kernel molto più intensivo di registrazione che incorpora "),Da={href:"https://github.com/google/sanitizers/wiki/AddressSanitizer",target:"_blank",rel:"noopener noreferrer"},Aa=o("AddressSanitizer"),Pa=o("."),Ka=l("p",null,"Una volta deciso quale kernel è l'ideale per te, aggiungi l'argomento kcsuffix ai tuoi argomenti di avvio nel tuo config.plist",-1),Ba=l("h4",{id:"_6-riavvia-e-controlla-il-tuo-lavoro",tabindex:"-1"},[l("a",{class:"header-anchor",href:"#_6-riavvia-e-controlla-il-tuo-lavoro","aria-hidden":"true"},"#"),o(" 6. Riavvia e controlla il tuo lavoro")],-1),Ca=l("p",null,"Supponendo che tutto sia stato fatto correttamente, ora vorrai riavviare e verificare che sia stato avviato il kernel corretto:",-1),Ia=l("div",{class:"language-bash ext-sh line-numbers-mode"},[l("pre",{class:"language-bash"},[l("code",null,"sysctl kern.osbuildconfig\n kern.osbuildconfig: kasan\n")]),l("div",{class:"line-numbers"},[l("span",{class:"line-number"},"1"),l("br"),l("span",{class:"line-number"},"2"),l("br")])],-1),Oa=l("p",null,"E come possiamo vedere, stiamo avviando con successo un kernel KASAN.",-1),Ra=l("h3",{id:"disinstallazione-di-kdk",tabindex:"-1"},[l("a",{class:"header-anchor",href:"#disinstallazione-di-kdk","aria-hidden":"true"},"#"),o(" Disinstallazione di KDK")],-1),Ea=l("p",null,"La disinstallazione del KDK è abbastanza semplice, tuttavia può essere un po 'distruttiva se non si presta attenzione.",-1),Ta=l("ol",null,[l("li",null,"Montare la partizione root come scrivibile (macOS 10.15+)"),l("li",null,"Rimuovi il kernel di debug e kexts"),l("li",null,"Riattiva SIP"),l("li",null,"Ripulire Argomenti di avvio"),l("li",null,"Riavvia e controlla il tuo lavoro")],-1),ya=l("p",null,"Steps:",-1),Fa=l("h4",{id:"_1-montare-la-partizione-root-come-scrivibile-macos-10-15",tabindex:"-1"},[l("a",{class:"header-anchor",href:"#_1-montare-la-partizione-root-come-scrivibile-macos-10-15","aria-hidden":"true"},"#"),o(" 1. Montare la partizione root come scrivibile (macOS 10.15+)")],-1),Ua=l("div",{class:"language-bash ext-sh line-numbers-mode"},[l("pre",{class:"language-bash"},[l("code",null,[l("span",{class:"token comment"},"# Big Sur+"),o("\n"),l("span",{class:"token comment"},"# Innanzitutto, crea un mount point per la tua unità"),o("\n"),l("span",{class:"token comment"},"# Salta se ancora presente il volume di montaggio dell'ultima volta"),o("\n"),l("span",{class:"token function"},"mkdir"),o(" ~/livemount\n\n"),l("span",{class:"token comment"},"# Quindi, trova il tuo volume di sistema"),o("\ndiskutil list\n\n"),l("span",{class:"token comment"},"# Dall'elenco sottostante, possiamo vedere che il nostro volume di sistema è disk5s5"),o("\n/dev/disk5 "),l("span",{class:"token punctuation"},"("),o("synthesized"),l("span",{class:"token punctuation"},")"),o(":\n   "),l("span",{class:"token comment"},"#:                       TYPE NAME                    SIZE       IDENTIFIER"),o("\n   "),l("span",{class:"token number"},"0"),o(":      APFS Container Scheme -                      +255.7 GB   disk5\n                                 Physical Store disk4s2\n   "),l("span",{class:"token number"},"1"),o(":                APFS Volume ⁨Big Sur HD - Data⁩       "),l("span",{class:"token number"},"122.5"),o(" GB   disk5s1\n   "),l("span",{class:"token number"},"2"),o(":                APFS Volume ⁨Preboot⁩                 "),l("span",{class:"token number"},"309.4"),o(" MB   disk5s2\n   "),l("span",{class:"token number"},"3"),o(":                APFS Volume ⁨Recovery⁩                "),l("span",{class:"token number"},"887.8"),o(" MB   disk5s3\n   "),l("span",{class:"token number"},"4"),o(":                APFS Volume ⁨VM⁩                      "),l("span",{class:"token number"},"1.1"),o(" MB     disk5s4\n   "),l("span",{class:"token number"},"5"),o(":                APFS Volume ⁨Big Sur HD⁩              "),l("span",{class:"token number"},"16.2"),o(" GB    disk5s5\n   "),l("span",{class:"token number"},"6"),o(":              APFS Snapshot ⁨com.apple.os.update-"),l("span",{class:"token punctuation"},".."),o(".⁩ "),l("span",{class:"token number"},"16.2"),o(" GB    disk5s5s\n\n"),l("span",{class:"token comment"},"# Montare l'unità (es. Disk5s5)"),o("\n"),l("span",{class:"token function"},"sudo"),o(),l("span",{class:"token function"},"mount"),o(" -o nobrowse -t apfs  /dev/disk5s5 ~/livemount\n")])]),l("div",{class:"line-numbers"},[l("span",{class:"line-number"},"1"),l("br"),l("span",{class:"line-number"},"2"),l("br"),l("span",{class:"line-number"},"3"),l("br"),l("span",{class:"line-number"},"4"),l("br"),l("span",{class:"line-number"},"5"),l("br"),l("span",{class:"line-number"},"6"),l("br"),l("span",{class:"line-number"},"7"),l("br"),l("span",{class:"line-number"},"8"),l("br"),l("span",{class:"line-number"},"9"),l("br"),l("span",{class:"line-number"},"10"),l("br"),l("span",{class:"line-number"},"11"),l("br"),l("span",{class:"line-number"},"12"),l("br"),l("span",{class:"line-number"},"13"),l("br"),l("span",{class:"line-number"},"14"),l("br"),l("span",{class:"line-number"},"15"),l("br"),l("span",{class:"line-number"},"16"),l("br"),l("span",{class:"line-number"},"17"),l("br"),l("span",{class:"line-number"},"18"),l("br"),l("span",{class:"line-number"},"19"),l("br"),l("span",{class:"line-number"},"20"),l("br"),l("span",{class:"line-number"},"21"),l("br"),l("span",{class:"line-number"},"22"),l("br")])],-1),wa=l("div",{class:"language-bash ext-sh line-numbers-mode"},[l("pre",{class:"language-bash"},[l("code",null,[l("span",{class:"token comment"},"# Solo Catalina"),o("\n"),l("span",{class:"token function"},"sudo"),o(),l("span",{class:"token function"},"mount"),o(" -uw /\n")])]),l("div",{class:"line-numbers"},[l("span",{class:"line-number"},"1"),l("br"),l("span",{class:"line-number"},"2"),l("br")])],-1),qa=l("h4",{id:"_2-rimuovi-il-kernel-di-debug-e-kexts",tabindex:"-1"},[l("a",{class:"header-anchor",href:"#_2-rimuovi-il-kernel-di-debug-e-kexts","aria-hidden":"true"},"#"),o(" 2. Rimuovi il kernel di debug e kexts")],-1),Na=l("div",{class:"language-bash ext-sh line-numbers-mode"},[l("pre",{class:"language-bash"},[l("code",null,[l("span",{class:"token comment"},"# Ripristina il precedente snapshot (Big Sur)"),o("\n"),l("span",{class:"token function"},"sudo"),o(" bless --mount ~/livemount --bootefi --last-sealed-snapshot\n")])]),l("div",{class:"line-numbers"},[l("span",{class:"line-number"},"1"),l("br"),l("span",{class:"line-number"},"2"),l("br")])],-1),Ma=l("div",{class:"language-bash ext-sh line-numbers-mode"},[l("pre",{class:"language-bash"},[l("code",null,[l("span",{class:"token comment"},"# Reset kernel cache (Catalina e versioni precedenti)"),o("\n"),l("span",{class:"token function"},"sudo"),o(),l("span",{class:"token function"},"rm"),o(" /System/Library/Caches/com.apple.kext.caches/Startup/kernelcache.de*\n"),l("span",{class:"token function"},"sudo"),o(),l("span",{class:"token function"},"rm"),o(" /System/Library/PrelinkedKernels/prelinkedkernel.de*\n"),l("span",{class:"token function"},"sudo"),o(" kextcache -invalidate /\n")])]),l("div",{class:"line-numbers"},[l("span",{class:"line-number"},"1"),l("br"),l("span",{class:"line-number"},"2"),l("br"),l("span",{class:"line-number"},"3"),l("br"),l("span",{class:"line-number"},"4"),l("br")])],-1),Ga=l("h4",{id:"_3-riabilitare-sip",tabindex:"-1"},[l("a",{class:"header-anchor",href:"#_3-riabilitare-sip","aria-hidden":"true"},"#"),o(" 3. Riabilitare SIP")],-1),La=l("ul",null,[l("li",null,"Comandi da usare in Recovery (se precedentemente modificati tramite Recovery):")],-1),Va=l("div",{class:"language-bash ext-sh line-numbers-mode"},[l("pre",{class:"language-bash"},[l("code",null,[o("csrutil "),l("span",{class:"token builtin class-name"},"enable"),o("\ncsrutil authenticated-root "),l("span",{class:"token builtin class-name"},"enable"),o(),l("span",{class:"token comment"},"# Big Sur+"),o("\n")])]),l("div",{class:"line-numbers"},[l("span",{class:"line-number"},"1"),l("br"),l("span",{class:"line-number"},"2"),l("br")])],-1),Xa=o("Modifiche al config.plist (se precedentemente modificato): "),Ha=o("Abilitare tramite config.plist"),Qa=l("h4",{id:"_4-ripulire-le-argomenti-di-avvio",tabindex:"-1"},[l("a",{class:"header-anchor",href:"#_4-ripulire-le-argomenti-di-avvio","aria-hidden":"true"},"#"),o(" 4. Ripulire le Argomenti di avvio")],-1),ja=l("p",null,[o("Non dimenticare di rimuovere "),l("code",null,"kcsuffix ="),o(" dalle Argomenti di avvio")],-1),Ya=l("h4",{id:"_5-riavvia-e-controlla-il-tuo-lavoro",tabindex:"-1"},[l("a",{class:"header-anchor",href:"#_5-riavvia-e-controlla-il-tuo-lavoro","aria-hidden":"true"},"#"),o(" 5. Riavvia e controlla il tuo lavoro")],-1),Za=l("p",null,"Supponendo che tutto sia stato fatto correttamente, ora devi riavviare e verificare che sia stato avviato il kernel corretto:",-1),Wa=l("div",{class:"language-bash ext-sh line-numbers-mode"},[l("pre",{class:"language-bash"},[l("code",null,"sysctl kern.osbuildconfig\n kern.osbuildconfig: release\n")]),l("div",{class:"line-numbers"},[l("span",{class:"line-number"},"1"),l("br"),l("span",{class:"line-number"},"2"),l("br")])],-1),Ja=l("p",null,"E come possiamo vedere, stiamo avviando con successo un kernel KASAN.",-1);t.render=function(o,r){const t=e("RouterLink"),$a=e("OutboundLink");return n(),a(s,null,[u,c,p,l("nav",d,[l("ul",null,[l("li",null,[l(t,{to:"#efi-setup"},{default:i((()=>[m])),_:1})]),l("li",null,[l(t,{to:"#configurazione-config-plist"},{default:i((()=>[b])),_:1}),l("ul",null,[l("li",null,[l(t,{to:"#misc"},{default:i((()=>[g])),_:1})]),l("li",null,[l(t,{to:"#nvram"},{default:i((()=>[h])),_:1})])])]),l("li",null,[l(t,{to:"#serial-setup-opzionale"},{default:i((()=>[v])),_:1}),l("ul",null,[l("li",null,[l(t,{to:"#hardware-setup"},{default:i((()=>[k])),_:1})]),l("li",null,[l(t,{to:"#coolterm-setup"},{default:i((()=>[f])),_:1})])])]),l("li",null,[l(t,{to:"#kernel-debug-kits-opzionale"},{default:i((()=>[z])),_:1}),l("ul",null,[l("li",null,[l(t,{to:"#kdk-su-un-sistema-operativo-installato"},{default:i((()=>[S])),_:1})]),l("li",null,[l(t,{to:"#disinstallazione-di-kdk"},{default:i((()=>[x])),_:1})])])])])]),_,l("p",null,[D,A,P,K,B,l(t,{to:"/troubleshooting/debug.html"},{default:i((()=>[C])),_:1})]),I,l("ul",null,[l("li",null,[l("p",null,[l("a",O,[R,l($a)])]),l("ul",null,[l("li",null,[E,l("a",T,[y,l($a)]),F]),U])]),l("li",null,[l("p",null,[l("a",w,[q,l($a)])]),l("ul",null,[N,l("li",null,[M,l(t,{to:"/Getting-Started-With-ACPI/Manual/compile.html"},{default:i((()=>[G])),_:1})])])])]),L,V,X,l("ul",null,[H,l("li",null,[Q,j,Y,l("ul",null,[Z,W,l("li",null,[J,l(t,{to:"/troubleshooting/debug.html"},{default:i((()=>[$])),_:1})])])])]),ee,ne,ae,le,ie,l("ul",null,[se,oe,l("li",null,[re,l("ul",null,[te,l("li",null,[ue,l("a",ce,[pe,l($a)])])])]),de]),me,be,l("ul",null,[ge,l("li",null,[he,l("ul",null,[l("li",null,[ve,ke,fe,l("a",ze,[Se,l($a)]),xe]),_e])]),l("li",null,[De,l("ul",null,[l("li",null,[Ae,Pe,Ke,l("a",Be,[Ce,l($a)]),Ie]),Oe])])]),Re,Ee,Te,ye,l("ul",null,[Fe,Ue,we,l("li",null,[qe,l("ul",null,[l("li",null,[Ne,l("a",Me,[Ge,l($a)]),Le,Ve])])])]),Xe,He,Qe,je,Ye,Ze,l("p",null,[We,l("a",Je,[$e,l($a)]),en,l("a",nn,[an,l($a)]),ln]),sn,on,rn,tn,un,l("p",null,[cn,l("a",pn,[dn,l($a)]),mn]),bn,gn,hn,vn,kn,fn,zn,Sn,xn,_n,Dn,l("p",null,[An,l("a",Pn,[Kn,l($a)]),Bn,l("a",Cn,[In,l($a)]),On]),l("ul",null,[l("li",null,[Rn,l("a",En,[Tn,l($a)])]),yn]),Fn,Un,wn,qn,Nn,Mn,Gn,Ln,Vn,Xn,Hn,Qn,jn,Yn,Zn,l("ul",null,[Wn,l("li",null,[l("p",null,[l(t,{to:"/troubleshooting/extended/post-issues.html#disabling-sip"},{default:i((()=>[Jn])),_:1})])])]),$n,ea,na,aa,l("ul",null,[l("li",null,[la,ia,l(t,{to:"/OpenCore-Post-Install/universal/security/applesecureboot.html#apecid"},{default:i((()=>[sa])),_:1}),oa,ra,ta])]),ua,ca,pa,da,ma,ba,ga,ha,va,ka,fa,l("p",null,[za,Sa,xa,_a,l("a",Da,[Aa,l($a)]),Pa]),Ka,Ba,Ca,Ia,Oa,Ra,Ea,Ta,ya,Fa,Ua,wa,qa,Na,Ma,Ga,La,Va,l("ul",null,[l("li",null,[Xa,l("ul",null,[l("li",null,[l(t,{to:"/troubleshooting/extended/post-issues.html#disabilitare-sip"},{default:i((()=>[Ha])),_:1})])])])]),Qa,ja,Ya,Za,Wa,Ja],64)};export default t;
